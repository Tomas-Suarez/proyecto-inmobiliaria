@{
  int? estadoSeleccionado = ViewData["EstadoSeleccionado"] as int?;
  DateTime? fechaDesde = ViewData["FechaDesde"] as DateTime?;
  DateTime? fechaHasta = ViewData["FechaHasta"] as DateTime?;
}

<div class="modal fade" id="modalFiltros" tabindex="-1" aria-labelledby="modalFiltrosLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">

      <div class="modal-header bg-info text-white">
        <h5 class="modal-title" id="modalFiltrosLabel">Filtros de Inmuebles</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
      </div>

      <div class="modal-body">
        <form method="get" asp-action="Index" id="formFiltros">

          <div class="mb-3">
            <label class="form-label">Seleccioná un filtro:</label>
            <div>
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="tipoFiltro" id="filtroEstado" value="estado" checked>
                <label class="form-check-label" for="filtroEstado">Por Estado</label>
              </div>
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="tipoFiltro" id="filtroFecha" value="fecha">
                <label class="form-check-label" for="filtroFecha">Por Fecha</label>
              </div>
            </div>
          </div>

          <div id="seccionEstado">
            <label for="estado">Estado:</label>
            <select name="estado" class="form-control"
              asp-items="@(new SelectList(ViewBag.EstadosInmueble, "Value", "Text", estadoSeleccionado))">
              <option value="">Todos</option>
            </select>
          </div>

          <div id="seccionFecha" style="display:none; margin-top: 15px;">
            <div class="alert alert-info d-flex align-items-center" role="alert">
              <i class="fa-solid fa-circle-info me-2"></i>
              <div>
                Se mostrarán solo los inmuebles que <strong>no tengan contratos activos</strong> entre las fechas seleccionadas.
              </div>
            </div>
            <div class="form-group mb-3">
              <label for="fechaDesde">Fecha desde:</label>
              <input type="date" name="fechaDesde" class="form-control"
                value="@(fechaDesde.HasValue? fechaDesde.Value.ToString("yyyy-MM-dd") : "")" />
            </div>
            <div class="form-group mb-3">
              <label for="fechaHasta">Fecha hasta:</label>
              <input type="date" name="fechaHasta" class="form-control"
                value="@(fechaHasta.HasValue? fechaHasta.Value.ToString("yyyy-MM-dd") : "")" />
            </div>
          </div>

        </form>
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
        <button type="submit" class="btn btn-primary" form="formFiltros">Aplicar filtros</button>
        <a href="@Url.Action("Index", "Inmueble")" class="btn btn-outline-danger">Borrar filtros</a>
      </div>

    </div>
  </div>
</div>

<script>
  const filtroEstado = document.getElementById("filtroEstado");
  const filtroFecha = document.getElementById("filtroFecha");
  const seccionEstado = document.getElementById("seccionEstado");
  const seccionFecha = document.getElementById("seccionFecha");

  filtroEstado.addEventListener("change", () => {
    if (filtroEstado.checked) {
      seccionEstado.style.display = "block";
      seccionFecha.style.display = "none";
    }
  });

  filtroFecha.addEventListener("change", () => {
    if (filtroFecha.checked) {
      seccionEstado.style.display = "none";
      seccionFecha.style.display = "block";
    }
  });
</script>
